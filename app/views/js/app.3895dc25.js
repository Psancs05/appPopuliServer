(function(){"use strict";var t={2877:function(t,e,o){var a=o(144),r=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("v-app",[o("v-main",[o("v-footer",{attrs:{app:"",fixed:"",padless:"",color:"white"}},[o("v-card",{attrs:{color:"#178649",width:"100%",height:"100%"}},[o("v-tabs",{attrs:{"background-color":"#178649",centered:"","fixed-tabs":"",dark:"","icons-and-text":"",optional:""},model:{value:t.activeTab,callback:function(e){t.activeTab=e},expression:"activeTab"}},t._l(t.icons,(function(e){return o("v-tab",{key:e,staticStyle:{"text-decoration":"none"},attrs:{to:e.ruta}},[o("div",{staticClass:"texto_iconos"},[t._v(" "+t._s(e.nombre)+" ")]),o("v-icon",[t._v(" "+t._s(e.icono)+" ")])],1)})),1)],1)],1),o("router-view")],1)],1)},s=[],i={data:()=>({activeTab:1,icons:[{nombre:"AYUDA",icono:"mdi-help",ruta:"/ayuda"},{nombre:"INICIO",icono:"mdi-home",ruta:"/"},{nombre:"EXPLORAR",icono:"mdi-map-marker",ruta:"/explorar"}]})},n=i,l=o(1001),c=o(3453),d=o.n(c),u=o(7524),p=o(2371),m=o(1966),v=o(6428),g=o(7877),f=o(4227),h=o(7090),b=(0,l.Z)(n,r,s,!1,null,null,null),_=b.exports;d()(b,{VApp:u.Z,VCard:p.Z,VFooter:m.Z,VIcon:v.Z,VMain:g.Z,VTab:f.Z,VTabs:h.Z});var x=o(9132);a.Z.use(x.Z);var y=new x.Z({}),w=o(8345),k=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-app",[a("IconoUsuario"),a("div",{staticClass:"titulo"},[a("img",{attrs:{src:o(6949),width:"180",height:"144"}})]),a("div",{staticClass:"cuerpo"},[a("v-container",{staticStyle:{width:"95%","max-width":"500px"},attrs:{fluid:""}},[a("v-btn",{staticStyle:{"text-decoration":"none"},attrs:{dark:"",width:"100%",height:"50",color:"#ff5d55",to:"/informe"}},[t._v(" enviar informe ")]),a("v-divider"),t.currentUser?a("v-btn",{attrs:{dark:"",width:"100%",height:"50",color:"#178649"},on:{click:t.logout}},[t._v(" cerrar sesión ")]):a("v-btn",{staticStyle:{"text-decoration":"none"},attrs:{dark:"",width:"100%",height:"50",color:"#178649",to:"/login"}},[t._v(" iniciar sesión ")])],1)],1)],1)},S=[],Z=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"icono_usuario"},[o("v-icon",{attrs:{disabled:!t.currentUser,large:"",color:"#178649"}},[t._v(" mdi-account-circle ")]),t.currentUser?o("v-menu",{attrs:{"offset-y":""},scopedSlots:t._u([{key:"activator",fn:function(e){var a=e.on,r=e.attrs;return[o("lab",t._g(t._b({attrs:{color:"primary",dark:""}},"lab",r,!1),a),[t._v(" "+t._s(t.currentUser.contact)+" ")])]}}],null,!1,2053519833)},[o("v-list",[o("v-list-item",{attrs:{link:""}},[o("v-list-item-title",{on:{click:t.logout}},[t._v(" Cerrar sesión ")])],1)],1)],1):t._e()],1)},C=[],I={computed:{currentUser(){return this.$store.state.auth.user}},methods:{logout(){this.$store.dispatch("auth/logout")}}},V=I,O=o(6816),T=o(7620),$=o(6147),L=o(1152),M=(0,l.Z)(V,Z,C,!1,null,null,null),E=M.exports;d()(M,{VIcon:v.Z,VList:O.Z,VListItem:T.Z,VListItemTitle:$.V9,VMenu:L.Z});var A={components:{IconoUsuario:E},computed:{currentUser(){return this.$store.state.auth.user}},methods:{logout(){this.$store.dispatch("auth/logout")}}},P=A,U=o(680),D=o(2255),F=o(1418),j=(0,l.Z)(P,k,S,!1,null,null,null),z=j.exports;d()(j,{VApp:u.Z,VBtn:U.Z,VContainer:D.Z,VDivider:F.Z});var R=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{attrs:{id:"informe"}},[o("IconoUsuario"),o("div",{staticClass:"titulo"},[t._v(" Informe ")]),o("div",{staticClass:"cuerpo"},[o("v-container",{staticStyle:{width:"95%","max-width":"500px"},attrs:{fluid:""}},[o("div",{staticClass:"asterisco"},[t._v(" Los campos acompañados de un asterisco (*) son "),o("lab",{staticStyle:{color:"#ff5d55"}},[t._v("obligatorios")])],1),o("br"),o("v-form",[o("v-select",{attrs:{clearable:"",label:"Plaga/Enfermedad (si se conoce)",color:"#178649",items:t.patogenos,"item-value":"nombre_cientifico","item-text":"nombre_cientifico"},scopedSlots:t._u([{key:"item",fn:function(e){var a=e.item;return[o("i",[t._v(t._s(a.nombre_cientifico))]),t._v("   ("+t._s(a.nombre_vulgar)+") ")]}},{key:"selection",fn:function(e){var a=e.item;return[o("i",[t._v(t._s(a.nombre_cientifico))]),t._v("   ("+t._s(a.nombre_vulgar)+") ")]}}]),model:{value:t.informe.patogeno,callback:function(e){t.$set(t.informe,"patogeno",e)},expression:"informe.patogeno"}},[o("v-tooltip",{attrs:{slot:"append-outer",top:""},slot:"append-outer",scopedSlots:t._u([{key:"activator",fn:function(e){var a=e.on;return[o("router-link",{attrs:{to:"/ayuda"}},[o("v-icon",t._g({attrs:{size:"20",color:"#178649"}},a),[t._v(" mdi-help ")])],1)]}}])},[o("span",[t._v(" Encontrarás más información acerca de plagas y enfermedades que afectan al chopo en el apartado de ayuda ")])])],1)],1),o("upload-files"),o("v-form",{ref:"form",model:{value:t.valid,callback:function(e){t.valid=e},expression:"valid"}},[o("v-menu",{attrs:{"close-on-content-click":!1,transition:"scale-transition","offset-y":"","max-width":"290px","min-width":"auto"},scopedSlots:t._u([{key:"activator",fn:function(e){var a=e.on,r=e.attrs;return[o("v-text-field",t._g(t._b({attrs:{label:"Fecha (*)",color:"#178649",hint:"DD/MM/AA",readonly:""},model:{value:t.computedDateFormatted,callback:function(e){t.computedDateFormatted=e},expression:"computedDateFormatted"}},"v-text-field",r,!1),a))]}}]),model:{value:t.menuDate,callback:function(e){t.menuDate=e},expression:"menuDate"}},[o("v-date-picker",{attrs:{"no-title":"","first-day-of-week":1,locale:"es-es",color:"#178649"},on:{input:function(e){t.menuDate=!1}},model:{value:t.date,callback:function(e){t.date=e},expression:"date"}})],1),o("v-dialog",{attrs:{width:"800"},scopedSlots:t._u([{key:"activator",fn:function(e){var a=e.on,r=e.attrs;return[o("v-text-field",t._g(t._b({attrs:{required:"",rules:t.reglaObligatorio,value:t.location.address,label:"Localización (*)",color:"#178649",readonly:""}},"v-text-field",r,!1),a))]}}]),model:{value:t.dialog,callback:function(e){t.dialog=e},expression:"dialog"}},[o("v-card",[o("v-btn",{attrs:{fab:"",dark:"",fixed:"",top:"",right:"","x-small":"",color:"#ff5d55"},on:{click:function(e){t.dialog=!1}}},[o("v-icon",[t._v("mdi-close")])],1),o("div",{staticStyle:{height:"400px"}},[o("InformeMapa",{model:{value:t.location,callback:function(e){t.location=e},expression:"location"}})],1),o("v-card-actions",{staticClass:"justify-center"},[o("v-btn",{attrs:{dark:"",width:"100%","max-width":"500px",height:"50",color:"#ff5d55"},on:{click:function(e){t.dialog=!1}}},[t._v(" aceptar ")])],1)],1)],1),o("v-select",{attrs:{required:"",rules:t.reglaObligatorio,label:"Total de árboles dañados (*)",color:"#178649",suffix:"árbol/es",items:t.extension},model:{value:t.informe.extension_arboles,callback:function(e){t.$set(t.informe,"extension_arboles",e)},expression:"informe.extension_arboles"}},[o("v-tooltip",{attrs:{slot:"append-outer",top:""},slot:"append-outer",scopedSlots:t._u([{key:"activator",fn:function(e){var a=e.on;return[o("v-icon",t._g({attrs:{size:"20",color:"#178649"}},a),[t._v(" mdi-help ")])]}}])},[o("span",[t._v("si me disculpa")])])],1),o("v-text-field",{attrs:{required:"",label:"Porcentaje de pies afectados (*)",color:"#178649",suffix:"%",rules:t.reglasExtension},model:{value:t.informe.extension_pies,callback:function(e){t.$set(t.informe,"extension_pies",e)},expression:"informe.extension_pies"}},[o("v-tooltip",{attrs:{slot:"append-outer",top:""},slot:"append-outer",scopedSlots:t._u([{key:"activator",fn:function(e){var a=e.on;return[o("v-icon",t._g({attrs:{size:"20",color:"#178649"}},a),[t._v(" mdi-help ")])]}}])},[o("span",[t._v("si me disculpa")])])],1),o("v-select",{attrs:{label:"Severidad del daño",color:"#178649",suffix:"%",items:t.severidadOpciones},model:{value:t.informe.severidad,callback:function(e){t.$set(t.informe,"severidad",e)},expression:"informe.severidad"}},[o("v-tooltip",{attrs:{slot:"append-outer",top:""},slot:"append-outer",scopedSlots:t._u([{key:"activator",fn:function(e){var a=e.on;return[o("v-icon",t._g({attrs:{size:"20",color:"#178649"}},a),[t._v(" mdi-help ")])]}}])},[o("span",[t._v("si me disculpa")])])],1),o("v-textarea",{attrs:{color:"#178649","auto-grow":""},scopedSlots:t._u([{key:"label",fn:function(){return[t._v(" Observaciones ")]},proxy:!0}]),model:{value:t.informe.observaciones,callback:function(e){t.$set(t.informe,"observaciones",e)},expression:"informe.observaciones"}},[o("v-tooltip",{attrs:{slot:"append-outer",top:""},slot:"append-outer",scopedSlots:t._u([{key:"activator",fn:function(e){var a=e.on;return[o("v-icon",t._g({attrs:{size:"20",color:"#178649"}},a),[t._v(" mdi-help ")])]}}])},[o("span",[t._v("Si se conoce, incluir el nombre del clon y la edad")])])],1),o("v-text-field",{attrs:{required:"",rules:t.reglaObligatorio,label:"Teléfono o correo electrónico (*)",color:"#178649"},model:{value:t.informe.contacto,callback:function(e){t.$set(t.informe,"contacto",e)},expression:"informe.contacto"}}),o("v-divider"),o("v-btn",{staticClass:"white--text",attrs:{width:"100%",height:"50",color:"#ff5d55",disabled:!t.valid},on:{click:t.validar}},[t._v(" enviar ")])],1)],1)],1)],1)},q=[],B=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("l-map",{ref:"map",staticStyle:{"z-index":"0"},attrs:{zoom:"14",center:[t.position.lat||t.userLocation.lat||t.defaultLocation.lat,t.position.lng||t.userLocation.lng||t.defaultLocation.lng]},on:{dblclick:t.onMapClick}},[o("l-geosearch",{attrs:{options:t.geoSearchOptions}}),t._l(t.tileProviders,(function(t){return o("l-tile-layer",{key:t.name,attrs:{name:t.name,visible:t.visible,url:t.url,attribution:t.attribution,"layer-type":"base"}})})),o("l-control-layers",{attrs:{position:"topright"}}),t.position.lat&&t.position.lng?o("l-marker",{attrs:{visible:"",draggable:"",icon:t.icon,"lat-lng":t.position},on:{"update:latLng":function(e){t.position=e},"update:lat-lng":function(e){t.position=e},dragstart:function(e){t.dragging=!0},dragend:function(e){t.dragging=!1}}}):t._e()],2)},N=[],G=o(458),H=o(5843),Y=o(9240),J=o(1739),Q=o(5200),W=o(8993),X=o(9344),K={components:{LMap:G.Z,LTileLayer:H.Z,LControlLayers:Y.Z,LMarker:J.Z,LGeosearch:W.Z},props:{value:{type:Object,required:!0},defaultLocation:{type:Object,default:()=>({lat:42.55057050005772,lng:-6.598203246805054})}},data(){return{loading:!1,geoSearchOptions:{provider:new Q.Zm,autoClose:!0,searchLabel:"Buscar una dirección"},userLocation:{},icon:(0,X.icon)({iconUrl:o(3994),iconSize:[22,36],iconAnchor:[11,36]}),position:{},address:"",tileProviders:[{name:"Mapa",visible:!0,attribution:'&copy; <a target="_blank" href="http://osm.org/copyright">OpenStreetMap</a> contributors',url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"},{name:"Satélite",visible:!1,attribution:'&copy; <a target="_blank" href="http://osm.org/copyright">OpenStreetMap</a> contributors',url:"https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}.png"}]}},mounted(){this.getUserPosition(),this.$refs.map.mapObject.on("geosearch/showlocation",this.onSearch)},watch:{position:{deep:!0,async handler(t){this.address=await this.getAddress(),this.$emit("input",{position:t,address:this.address,lat:this.position.lat,lng:this.position.lng})}}},methods:{async getUserPosition(){navigator.geolocation&&navigator.geolocation.getCurrentPosition((t=>{this.userLocation={lat:t.coords.latitude,lng:t.coords.longitude}}))},async getAddress(){this.loading=!0;let t="Unresolved address";try{const{lat:e,lng:o}=this.position,a=await fetch(`https://nominatim.openstreetmap.org/reverse?format=jsonv2&lat=${e}&lon=${o}`);if(200===a.status){const e=await a.json();t=e.display_name}}catch(e){console.error("Reverse Geocode Error->",e)}return this.loading=!1,t},onMapClick(t){this.position=t.latlng},onSearch(t){const e=t.location;this.position={lat:e.y,lng:e.x}}}},tt=K,et=(0,l.Z)(tt,B,N,!1,null,null,null),ot=et.exports,at=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",[t.progressInfos?o("div",t._l(t.progressInfos,(function(e,a){return o("div",{key:a,staticClass:"mb-2"},[o("span",[t._v(t._s(e.fileName))]),o("div",{staticClass:"progress"},[o("div",{staticClass:"progress-bar progress-bar-info",staticStyle:{"background-color":"#178649"},style:{width:e.percentage+"%"},attrs:{role:"progressbar","aria-valuenow":e.percentage,"aria-valuemin":"0","aria-valuemax":"100"}},[t._v(" "+t._s(e.percentage)+"% ")])])])})),0):t._e(),o("label",{staticClass:"boton_examinar btn"},[o("v-icon",{attrs:{color:"#178649",size:"17"}},[t._v("mdi-camera")]),t._v(" SELECCIONAR ARCHIVOS "),o("input",{staticStyle:{display:"none"},attrs:{type:"file",multiple:""},on:{change:t.selectFile}})],1),o("button",{staticClass:"boton_subir btn",attrs:{disabled:!t.selectedFiles},on:{click:t.uploadFiles}},[t._v(" SUBIR ARCHIVOS ")]),o("br"),o("br"),t.message?o("div",{staticClass:"alert alert-light",attrs:{role:"alert"}},[o("ul",t._l(t.message.split("\n"),(function(e,a){return o("li",{key:a},[t._v(" "+t._s(e)+" ")])})),0)]):t._e()])},rt=[],st=o(9669),it=o.n(st),nt=it().create({baseURL:"https://test.apppopuli.es/api",headers:{"Access-Control-Allow-Origin":"*","Access-Control-Allow-Methods":"GET, PUT, POST, DELETE, PATCH, OPTIONS","Content-type":"application/json"}});class lt{upload(t,e){let o=new FormData;return o.append("file",t),nt.post("/upload",o,{headers:{"Content-Type":"multipart/form-data"},onUploadProgress:e})}download(t){return nt.get(`/files/${t}.pdf`,{headers:{"Content-Type":"multipart/form-data"},responseType:"blob"})}show(t){return nt.get(`/images/${t}.jpg`,{headers:{"Content-Type":"image/jpg"},responseType:"blob"})}getFiles(){return nt.get("/files")}}var ct=new lt,dt={name:"upload-files",data(){return{selectedFiles:void 0,progressInfos:[],message:"",fileInfos:[]}},methods:{selectFile(t){this.progressInfos=[],this.selectedFiles=t.target.files},upload(t,e){this.progressInfos[t]={percentage:0,fileName:e.name},ct.upload(e,(e=>{this.progressInfos[t].percentage=Math.round(100*e.loaded/e.total)})).then((t=>{let e=this.message?this.message+"\n":"";return this.message=e+t.data.message,ct.getFiles()})).then((t=>{this.fileInfos=t.data})).catch((()=>{this.progressInfos[t].percentage=0,this.message="El archivo no se ha podido enviar correctamente: "+e.name}))},uploadFiles(){this.message="";for(let t=0;t<this.selectedFiles.length;t++)this.upload(t,this.selectedFiles[t])}},mounted(){ct.getFiles().then((t=>{this.fileInfos=t.data}))}},ut=dt,pt=(0,l.Z)(ut,at,rt,!1,null,null,null),mt=pt.exports;d()(pt,{VIcon:v.Z});class vt{create(t){return nt.post("/informes",t)}getAll(){return nt.get("/informes")}}var gt=new vt;class ft{getAll(){return nt.get("/patogenos")}get(t){return nt.get(`/patogenos/${t}`)}}var ht=new ft,bt={components:{IconoUsuario:E,InformeMapa:ot,UploadFiles:mt},data:t=>({informe:{id:null,patogeno:"",extension_arboles:"",extension_pies:"",severidad:"",observaciones:"",contacto:""},valid:!1,patogenos:[],selectedFile:null,date:new Date(Date.now()-6e4*(new Date).getTimezoneOffset()).toISOString().substr(0,10),dateFormatted:t.formatDate(new Date(Date.now()-6e4*(new Date).getTimezoneOffset()).toISOString().substr(0,10)),menuDate:!1,dialog:!1,location:{},extension:["1","2-10","10-100","Más de 100"],severidadOpciones:["0-25","25-75","Más del 75"],reglaObligatorio:[t=>!!t||"Este campo es obligatorio"],reglasExtension:[t=>!!t||"Este campo es obligatorio",t=>/^[1-9][0-9]?$|^100$/.test(t)||"Introduce un valor numérico entre 1 y 100"]}),watch:{dialog(t){t&&setTimeout((()=>{window.dispatchEvent(new Event("resize"))}),100)}},computed:{currentUser(){return this.$store.state.auth.user},computedDateFormatted(){return this.formatDate(this.date)}},methods:{mostrarPatogenos(){ht.getAll().then((t=>{this.patogenos=t.data.map(this.getMostrarPatogeno),console.log(t.data)})).catch((t=>{console.log(t)}))},getMostrarPatogeno(t){return{nombre_cientifico:t.nombre_cientifico,nombre_vulgar:t.nombre_vulgar}},formatDate(t){if(!t)return null;const[e,o,a]=t.split("-");return`${a}/${o}/${e}`},guardarInforme(){var t={patogeno:this.informe.patogeno,fecha:this.date,localizacion:this.location.address,lat:this.location.lat,lng:this.location.lng,extension_arboles:this.informe.extension_arboles,extension_pies:this.informe.extension_pies,severidad:this.informe.severidad,observaciones:this.informe.observaciones,contacto:this.informe.contacto};gt.create(t).then((t=>{this.informe.id=t.data.id,console.log(t.data),this.$router.push("/gracias")})).catch((t=>{console.log(t)}))},validar(){this.$refs.form.validate(),this.guardarInforme()}},mounted(){this.mostrarPatogenos()}},_t=bt,xt=o(7118),yt=o(4484),wt=o(7336),kt=o(6232),St=o(7032),Zt=o(314),Ct=o(4350),It=o(9330),Vt=(0,l.Z)(_t,R,q,!1,null,null,null),Ot=Vt.exports;d()(Vt,{VBtn:U.Z,VCard:p.Z,VCardActions:xt.h7,VContainer:D.Z,VDatePicker:yt.Z,VDialog:wt.Z,VDivider:F.Z,VForm:kt.Z,VIcon:v.Z,VMenu:L.Z,VSelect:St.Z,VTextField:Zt.Z,VTextarea:Ct.Z,VTooltip:It.Z});var Tt=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"ayuda"},[o("IconoUsuario"),o("div",{staticClass:"titulo"},[t._v(" ¡Gracias! ")]),o("div",{staticClass:"cuerpo"},[o("v-card",{staticClass:"mx-auto",attrs:{width:"90%","max-width":"800",elevation:"0"}},[t._v(" Tu informe se ha enviado correctamente. "),o("br"),o("br"),t._v(" ¡Ayúdanos a mejorar! Queremos saber tu opinión sobre nuestra aplicacón. Rellenar este "),o("a",{staticStyle:{"font-weight":"bold",color:"#ff5d55","text-decoration":"none"},attrs:{href:"url"}},[t._v("formulario")]),t._v(" solo te llevará unos minutos. ")]),o("br"),o("br"),o("v-btn",{staticClass:"white--text",staticStyle:{"text-decoration":"none"},attrs:{width:"275",height:"50",color:"#178649",to:"/"}},[t._v(" no, gracias ")])],1)],1)},$t=[],Lt={components:{IconoUsuario:E}},Mt=Lt,Et=(0,l.Z)(Mt,Tt,$t,!1,null,null,null),At=Et.exports;d()(Et,{VBtn:U.Z,VCard:p.Z});var Pt=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{attrs:{id:"informe"}},[o("IconoUsuario"),o("div",{staticClass:"titulo"},[t._v(" Iniciar sesión ")]),o("div",{staticClass:"cuerpo"},[o("v-container",{staticStyle:{width:"95%","max-width":"500px"},attrs:{fluid:""}},[o("v-form",{ref:"form",attrs:{"lazy-validation":""},model:{value:t.valid,callback:function(e){t.valid=e},expression:"valid"}},[o("v-text-field",{attrs:{required:"",rules:t.reglaObligatorio,"append-outer-icon":"mdi-account",label:"Teléfono o correo electrónico",color:"#178649"},model:{value:t.user.contact,callback:function(e){t.$set(t.user,"contact",e)},expression:"user.contact"}}),o("v-text-field",{attrs:{required:"",rules:t.reglaObligatorio,"append-outer-icon":t.show?"mdi-eye":"mdi-eye-off",type:t.show?"text":"password",label:"Contraseña",color:"#178649"},on:{"click:append-outer":function(e){t.show=!t.show}},model:{value:t.user.password,callback:function(e){t.$set(t.user,"password",e)},expression:"user.password"}}),o("v-divider"),o("v-btn",{staticClass:"white--text",attrs:{width:"100%",height:"50",color:"#178649",disabled:!t.valid},on:{click:t.login}},[t._v(" iniciar sesión ")]),o("br"),o("br"),t.message?o("div",{staticClass:"alert alert-danger"},[t._v(" "+t._s(t.message)+" ")]):t._e()],1),o("br"),o("div",{staticClass:"registro"},[t._v(" ¿No tienes cuenta? "),o("router-link",{staticStyle:{"font-weight":"bold",color:"#ff5d55","text-decoration":"none"},attrs:{to:"/register"}},[t._v(" Regístrate ")])],1)],1)],1)],1)},Ut=[];class Dt{constructor(t,e){this.contact=t,this.password=e}}var Ft={components:{IconoUsuario:E},data(){return{valid:!1,show:!1,reglaObligatorio:[t=>!!t||"Este campo es obligatorio"],user:new Dt("",""),message:""}},computed:{loggedIn(){return this.$store.state.auth.status.loggedIn}},methods:{login(){this.$refs.form.validate(),this.user.contact&&this.user.password&&this.$store.dispatch("auth/login",this.user).then((()=>{this.$router.push("/")}),(t=>{this.message=t.response&&t.response.data||t.message||t.toString()}))}},mounted(){this.loggedIn&&this.$router.push("/")}},jt=Ft,zt=(0,l.Z)(jt,Pt,Ut,!1,null,null,null),Rt=zt.exports;d()(zt,{VBtn:U.Z,VContainer:D.Z,VDivider:F.Z,VForm:kt.Z,VTextField:Zt.Z});var qt=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{attrs:{id:"informe"}},[o("IconoUsuario"),o("div",{staticClass:"titulo"},[t._v(" Registrarse ")]),o("div",{staticClass:"cuerpo"},[o("v-container",{staticStyle:{width:"95%","max-width":"500px"},attrs:{fluid:""}},[o("v-form",{ref:"form",attrs:{"lazy-validation":""},model:{value:t.valid,callback:function(e){t.valid=e},expression:"valid"}},[o("v-text-field",{attrs:{required:"",rules:t.reglaObligatorio,"append-outer-icon":"mdi-account",label:"Teléfono o correo electrónico",color:"#178649"},model:{value:t.user.contact,callback:function(e){t.$set(t.user,"contact",e)},expression:"user.contact"}}),o("v-text-field",{attrs:{required:"",rules:t.reglaObligatorio,"append-outer-icon":t.show?"mdi-eye":"mdi-eye-off",type:t.show?"text":"password",label:"Contraseña",color:"#178649"},on:{"click:append-outer":function(e){t.show=!t.show}},model:{value:t.user.password,callback:function(e){t.$set(t.user,"password",e)},expression:"user.password"}}),o("v-divider"),o("v-btn",{staticClass:"white--text",attrs:{width:"100%",height:"50",color:"#178649",disabled:!t.valid},on:{click:t.register}},[t._v(" registrarse ")]),o("br"),o("br"),t.message?o("div",{staticClass:"alert alert-danger"},[t._v(" "+t._s(t.message)+" ")]):t._e()],1)],1)],1)],1)},Bt=[],Nt={components:{IconoUsuario:E},data(){return{valid:!1,show:!1,reglaObligatorio:[t=>!!t||"Este campo es obligatorio"],user:new Dt("",""),message:""}},computed:{loggedIn(){return!1}},methods:{register(){this.$refs.form.validate(),this.user.contact&&this.user.password&&this.$store.dispatch("auth/register",this.user).then((()=>{this.$store.dispatch("auth/login",this.user).then((()=>{this.$router.push("/")}))}),(t=>{this.message=t.response&&t.response.data||t.message||t.toString()}))}},mounted(){this.loggedIn&&this.$router.push("/")}},Gt=Nt,Ht=(0,l.Z)(Gt,qt,Bt,!1,null,null,null),Yt=Ht.exports;d()(Ht,{VBtn:U.Z,VContainer:D.Z,VDivider:F.Z,VForm:kt.Z,VTextField:Zt.Z});var Jt=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"ayuda"},[o("IconoUsuario"),o("div",{staticClass:"titulo"},[t._v(" Ayuda ")]),o("div",{staticStyle:{"padding-bottom":"10px"}},[o("v-card",{staticClass:"mx-auto",attrs:{width:"98%","max-width":"800"}},[o("v-tabs",{attrs:{"background-color":"#178649",grow:"",dark:""},model:{value:t.activeTab,callback:function(e){t.activeTab=e},expression:"activeTab"}},t._l(t.tabs,(function(e){return o("v-tab",{key:e},[o("div",{staticClass:"texto_tab"},[t._v(" "+t._s(e)+" ")])])})),1),o("v-tabs-items",{model:{value:t.activeTab,callback:function(e){t.activeTab=e},expression:"activeTab"}},[o("v-tab-item",[o("v-card",{attrs:{flat:""}},[o("v-card-text",{staticStyle:{"text-align":"justify"}},[t._v(" Usándola. ")])],1)],1),o("v-tab-item",[o("v-card",{staticClass:"mx-auto",attrs:{width:"98%",flat:""}},[o("v-card",{staticClass:"mx-auto",staticStyle:{"padding-top":"10px"},attrs:{width:"90%",flat:""}},[o("v-select",{attrs:{clearable:"",label:"Filtrar por síntomas",color:"#178649",dense:"",items:t.sintomas,"item-text":"descripcion","item-value":"id"},on:{input:t.filtrarPatogenos},model:{value:t.selectedSintoma,callback:function(e){t.selectedSintoma=e},expression:"selectedSintoma"}})],1),o("v-list",t._l(t.patogenos,(function(e){return o("v-list-group",{key:e,attrs:{color:"#178649","no-action":""},scopedSlots:t._u([{key:"activator",fn:function(){return[o("v-list-item-title",{staticStyle:{color:"#178649","font-weight":"bold"}},[o("i",[t._v(t._s(e.nombre_cientifico))]),t._v(" ("+t._s(e.nombre_vulgar)+") ")])]},proxy:!0}],null,!0)},[o("v-card",{attrs:{flat:""}},[o("v-list-item",[o("v-list-item-content",{staticStyle:{"text-align":"justify"}},[o("div",{staticClass:"titulo_patogeno"},[t._v(" ¿A quién ataca? "),o("br"),o("br")]),t._v(" "+t._s(e.parrafo_quien)+" "),o("div",{staticClass:"titulo_patogeno"},[o("br"),t._v(" ¿Cómo identificarlo? "),o("br"),o("br")]),t._v(" "+t._s(e.parrafo_como)+" "),o("div",{staticClass:"titulo_patogeno"},[o("br"),t._v(" ¿Qué daños causa? "),o("br"),o("br")]),t._v(" "+t._s(e.parrafo_que)+" "),o("div",{staticClass:"titulo_patogeno"},[o("br"),t._v(" ¿Cuándo verlo? "),o("br"),o("br")]),t._v(" "+t._s(e.parrafo_cuando)+" "),o("div",{staticClass:"cuerpo"},[o("v-btn",{staticStyle:{"margin-top":"30px"},attrs:{dark:"",width:"100%","max-width":"500px",height:"50",color:"#ff5d55"},on:{click:function(o){return t.download(e.id)}}},[t._v(" descargar ficha en formato pdf ")])],1)])],1)],1)],1)})),1)],1)],1)],1)],1)],1),o("v-btn",{staticClass:"boton_flotante",attrs:{fab:"",dark:"",fixed:"",bottom:"",right:"",color:"#ff5d55",to:"/informe"}},[o("v-icon",[t._v("mdi-launch")])],1)],1)},Qt=[];class Wt{getAll(){return nt.get("/sintomas")}}var Xt=new Wt,Kt={components:{IconoUsuario:E},data:()=>({activeTab:1,tabs:["CÓMO USAR LA APLICACIÓN","PLAGAS Y ENFERMEDADES"],patogenos:[],sintomas:[]}),methods:{mostrarPatogenos(){ht.getAll().then((t=>{this.patogenos=t.data,console.log(t.data)})).catch((t=>{console.log(t)}))},filtrarPatogenos(){null==this.selectedSintoma?this.mostrarPatogenos():ht.get(this.selectedSintoma).then((t=>{this.patogenos=t.data,console.log(t.data)})).catch((t=>{console.log(t)}))},getMostrarPatogeno(t){return{id:t.id,nombre_cientifico:t.nombre_cientifico,nombre_vulgar:t.nombre_vulgar,parrafo_quien:t.parrafo_quien,parrafo_como:t.parrafo_como,parrafo_que:t.parrafo_que,parrafo_cuando:t.parrafo_cuando,parrafo_confundir:t.parrafo_confundir}},mostrarSintomas(){Xt.getAll().then((t=>{this.sintomas=t.data,console.log(t.data)})).catch((t=>{console.log(t)}))},getMostrarSintoma(t){return{id:t.id,descripcion:t.descripcion}},download(t){ct.download(t).then((e=>{var o=window.URL.createObjectURL(new Blob([e.data])),a=document.createElement("a");a.href=o,a.setAttribute("download",`${t}.pdf`),document.body.appendChild(a),a.click()})).catch((t=>{console.log(t)}))},show(t){ct.show(t).then((e=>{var o=window.URL.createObjectURL(new Blob([e.data])),a=document.createElement("a");a.href=o,a.setAttribute("display",`${t}.jpg`),document.body.appendChild(a),a.click()})).catch((t=>{console.log(t)}))}},mounted(){this.mostrarPatogenos(),this.mostrarSintomas()}},te=Kt,ee=o(9443),oe=o(1759),ae=o(1954),re=(0,l.Z)(te,Jt,Qt,!1,null,null,null),se=re.exports;d()(re,{VBtn:U.Z,VCard:p.Z,VCardText:xt.ZB,VIcon:v.Z,VList:O.Z,VListGroup:ee.Z,VListItem:T.Z,VListItemContent:$.km,VListItemTitle:$.V9,VSelect:St.Z,VTab:f.Z,VTabItem:oe.Z,VTabs:h.Z,VTabsItems:ae.Z});var ie=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"ayuda"},[o("IconoUsuario"),o("div",{staticClass:"titulo"},[t._v(" Explorar ")]),o("div",{staticStyle:{"padding-bottom":"15px"}},[o("v-card",{staticClass:"mx-auto",attrs:{width:"98%","max-width":"800"}},[o("v-tabs",{attrs:{"background-color":"#178649",grow:"",dark:""},model:{value:t.tabModel,callback:function(e){t.tabModel=e},expression:"tabModel"}},[o("v-tab",[o("div",{staticClass:"texto_tab"},[t._v(" HISTORIAL DE INFORMES ")])])],1),o("v-tabs-items",{model:{value:t.tabModel,callback:function(e){t.tabModel=e},expression:"tabModel"}},[o("v-tab-item",[o("v-card",{attrs:{flat:""}},[o("v-card-text",[o("v-data-table",{staticClass:"elevation-2",attrs:{headers:t.headers,items:t.informes,page:t.page,"items-per-page":10,"header-props":t.headerProps,"hide-default-footer":""},on:{"update:page":function(e){t.page=e},"page-count":function(e){t.pageCount=e}}}),o("div",{staticClass:"text-center pt-2"},[o("v-pagination",{attrs:{color:"#178649",length:t.pageCount},model:{value:t.page,callback:function(e){t.page=e},expression:"page"}})],1)],1)],1)],1)],1)],1)],1),o("v-dialog",{attrs:{width:"800"},scopedSlots:t._u([{key:"activator",fn:function(e){var a=e.on,r=e.attrs;return[o("v-btn",t._g(t._b({staticClass:"boton_flotante",attrs:{fab:"",dark:"",fixed:"",bottom:"",left:"",color:"#178649"}},"v-btn",r,!1),a),[o("v-icon",[t._v("mdi-map")])],1)]}}]),model:{value:t.dialog,callback:function(e){t.dialog=e},expression:"dialog"}},[o("v-card",{attrs:{flat:""}},[o("v-btn",{attrs:{fab:"",dark:"",fixed:"",top:"",right:"","x-small":"",color:"#ff5d55"},on:{click:function(e){t.dialog=!1}}},[o("v-icon",[t._v("mdi-close")])],1),o("div",{staticStyle:{height:"400px"}},[o("ExplorarMapa")],1)],1)],1),o("v-btn",{staticClass:"boton_flotante",attrs:{fab:"",dark:"",fixed:"",bottom:"",right:"",color:"#ff5d55",to:"/informe"}},[o("v-icon",[t._v("mdi-launch")])],1)],1)},ne=[],le=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("l-map",{ref:"map",staticStyle:{"z-index":"0"},attrs:{zoom:"10",center:[t.position.lat||t.userLocation.lat||t.defaultLocation.lat,t.position.lng||t.userLocation.lng||t.defaultLocation.lng]}},[o("l-geosearch",{attrs:{options:t.geoSearchOptions}}),t._l(t.tileProviders,(function(t){return o("l-tile-layer",{key:t.name,attrs:{name:t.name,visible:t.visible,url:t.url,attribution:t.attribution,"layer-type":"base"}})})),o("l-control-layers",{attrs:{position:"topright"}}),t._l(t.informes,(function(e){return o("l-marker",{key:e,attrs:{visible:"",icon:t.icon,"lat-lng":e.position}},[o("l-tooltip",{attrs:{content:e.patogeno,options:t.tooltipOptions}})],1)}))],2)},ce=[],de=o(7737),ue={components:{LMap:G.Z,LTileLayer:H.Z,LControlLayers:Y.Z,LMarker:J.Z,LTooltip:de.Z,LGeosearch:W.Z},props:{value:{type:Object,required:!0},defaultLocation:{type:Object,default:()=>({lat:42.55057050005772,lng:-6.598203246805054})}},data(){return{loading:!1,geoSearchOptions:{provider:new Q.Zm,autoClose:!0,retainZoomLevel:!0,searchLabel:"Buscar una dirección"},userLocation:{},icon:(0,X.icon)({iconUrl:o(3994),iconSize:[22,36],iconAnchor:[11,36],tooltipAnchor:[0,-36]}),position:{},address:"",tileProviders:[{name:"Mapa",visible:!0,attribution:'&copy; <a target="_blank" href="http://osm.org/copyright">OpenStreetMap</a> contributors',url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"},{name:"Satélite",visible:!1,attribution:'&copy; <a target="_blank" href="http://osm.org/copyright">OpenStreetMap</a> contributors',url:"https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}.png"}],informes:[],tooltipOptions:{direction:"top"}}},mounted(){this.getUserPosition(),this.$refs.map.mapObject.on("geosearch/showlocation",this.onSearch),this.mostrarInformes()},watch:{position:{deep:!0,async handler(t){this.address=await this.getAddress(),this.$emit("input",{position:t,address:this.address})}}},methods:{async getUserPosition(){navigator.geolocation&&navigator.geolocation.getCurrentPosition((t=>{this.userLocation={lat:t.coords.latitude,lng:t.coords.longitude}}))},async getAddress(){this.loading=!0;let t="Unresolved address";try{const{lat:e,lng:o}=this.position,a=await fetch(`https://nominatim.openstreetmap.org/reverse?format=jsonv2&lat=${e}&lon=${o}`);if(200===a.status){const e=await a.json();t=e.display_name}}catch(e){console.error("Reverse Geocode Error->",e)}return this.loading=!1,t},onMapClick(t){this.position=t.latlng},onSearch(t){const e=t.location;this.position={lat:e.y,lng:e.x}},mostrarInformes(){gt.getAll().then((t=>{this.informes=t.data.map(this.getMostrarInforme),console.log(t.data)})).catch((t=>{console.log(t)}))},getMostrarInforme(t){return{patogeno:t.patogeno,position:{lat:t.lat,lng:t.lng}}}}},pe=ue,me=(0,l.Z)(pe,le,ce,!1,null,null,null),ve=me.exports,ge={components:{IconoUsuario:E,ExplorarMapa:ve},data:()=>({tabModel:0,dialog:!1,informes:[],headers:[{text:"Plaga o Enfermedad",value:"patogeno",sortable:!0},{text:"Fecha",value:"fecha",sortable:!0},{text:"Total de árboles dañados",value:"extension_arboles",sortable:!1},{text:"Severidad del daño",value:"severidad",sortable:!0},{text:"Localización",value:"localizacion",sortable:!0}],page:1,pageCount:0,headerProps:{sortByText:"Ordenar por"}}),watch:{dialog(t){t&&setTimeout((()=>{window.dispatchEvent(new Event("resize"))}),100)}},methods:{mostrarInformes(){gt.getAll().then((t=>{this.informes=t.data.map(this.getMostrarInforme),console.log(t.data)})).catch((t=>{console.log(t)}))},getMostrarInforme(t){return{patogeno:t.patogeno,fecha:this.formatDate(t.fecha),extension_arboles:t.extension_arboles,severidad:t.severidad,localizacion:t.localizacion}},formatDate(t){if(!t)return null;var e=new Date(t),o=("0"+e.getDate()).slice(-2)+"/"+("0"+(e.getMonth()+1)).slice(-2)+"/"+e.getFullYear();return o}},mounted(){this.mostrarInformes()}},fe=ge,he=o(4998),be=o(6325),_e=(0,l.Z)(fe,ie,ne,!1,null,null,null),xe=_e.exports;d()(_e,{VBtn:U.Z,VCard:p.Z,VCardText:xt.ZB,VDataTable:he.Z,VDialog:wt.Z,VIcon:v.Z,VPagination:be.Z,VTab:f.Z,VTabItem:oe.Z,VTabs:h.Z,VTabsItems:ae.Z}),a.Z.use(w.Z);const ye=[{path:"/",name:"inicio",component:z},{path:"/informe",name:"informe",component:Ot},{path:"/gracias",name:"gracias",component:At},{path:"/login",name:"login",component:Rt},{path:"/register",name:"register",component:Yt},{path:"/ayuda",name:"ayuda",component:se},{path:"/explorar",name:"explorar",component:xe}],we=new w.Z({routes:ye,scrollBehavior(){document.getElementById("app").scrollIntoView({behavior:"smooth"})}});var ke=we,Se=o(629);const Ze="https://test.apppopuli.es/api/users/";class Ce{login(t){return it().post(Ze+"login",{contact:t.contact,password:t.password}).then((t=>(t.data.accessToken&&localStorage.setItem("user",JSON.stringify(t.data)),t.data)))}logout(){localStorage.removeItem("user")}register(t){return it().post(Ze+"create",{contact:t.contact,password:t.password})}}var Ie=new Ce;const Ve=JSON.parse(localStorage.getItem("user")),Oe=Ve?{status:{loggedIn:!0},user:Ve}:{status:{loggedIn:!1},user:null},Te={namespaced:!0,state:Oe,actions:{login({commit:t},e){return Ie.login(e).then((e=>(t("loginSuccess",e),Promise.resolve(e))),(e=>(t("loginFailure"),Promise.reject(e))))},logout({commit:t}){Ie.logout(),t("logout")},register({commit:t},e){return Ie.register(e).then((e=>(t("registerSuccess"),Promise.resolve(e.data))),(e=>(t("registerFailure"),Promise.reject(e))))}},mutations:{loginSuccess(t,e){t.status.loggedIn=!0,t.user=e},loginFailure(t){t.status.loggedIn=!1,t.user=null},logout(t){t.status.loggedIn=!1,t.user=null},registerSuccess(t){t.status.loggedIn=!1},registerFailure(t){t.status.loggedIn=!1}}};a.Z.use(Se.ZP);var $e=new Se.ZP.Store({modules:{auth:Te}});a.Z.config.productionTip=!1,new a.Z({vuetify:y,router:ke,store:$e,render:t=>t(_)}).$mount("#app")},6949:function(t,e,o){t.exports=o.p+"img/logo.5d26a052.png"}},e={};function o(a){var r=e[a];if(void 0!==r)return r.exports;var s=e[a]={exports:{}};return t[a].call(s.exports,s,s.exports,o),s.exports}o.m=t,function(){var t=[];o.O=function(e,a,r,s){if(!a){var i=1/0;for(d=0;d<t.length;d++){a=t[d][0],r=t[d][1],s=t[d][2];for(var n=!0,l=0;l<a.length;l++)(!1&s||i>=s)&&Object.keys(o.O).every((function(t){return o.O[t](a[l])}))?a.splice(l--,1):(n=!1,s<i&&(i=s));if(n){t.splice(d--,1);var c=r();void 0!==c&&(e=c)}}return e}s=s||0;for(var d=t.length;d>0&&t[d-1][2]>s;d--)t[d]=t[d-1];t[d]=[a,r,s]}}(),function(){o.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return o.d(e,{a:e}),e}}(),function(){o.d=function(t,e){for(var a in e)o.o(e,a)&&!o.o(t,a)&&Object.defineProperty(t,a,{enumerable:!0,get:e[a]})}}(),function(){o.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){o.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}}(),function(){o.p="/"}(),function(){var t={143:0};o.O.j=function(e){return 0===t[e]};var e=function(e,a){var r,s,i=a[0],n=a[1],l=a[2],c=0;if(i.some((function(e){return 0!==t[e]}))){for(r in n)o.o(n,r)&&(o.m[r]=n[r]);if(l)var d=l(o)}for(e&&e(a);c<i.length;c++)s=i[c],o.o(t,s)&&t[s]&&t[s][0](),t[s]=0;return o.O(d)},a=self["webpackChunktest_apppopuli_es"]=self["webpackChunktest_apppopuli_es"]||[];a.forEach(e.bind(null,0)),a.push=e.bind(null,a.push.bind(a))}();var a=o.O(void 0,[998],(function(){return o(2877)}));a=o.O(a)})();
//# sourceMappingURL=app.3895dc25.js.map